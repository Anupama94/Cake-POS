68db321da18469bddbffa6ed6e2521b5
"use strict";

var _interopRequireDefault = require("/home/anupamaa/Desktop/Training/pos/server/client/node_modules/@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getMenuItems = exports.getUsersOrders = exports.updateOrder = exports.getOrderItems = exports.userLogin = void 0;

var _config = require("../apiCalls/config");

var _axios = _interopRequireDefault(require("axios"));

const baseUrl = "http://localhost:3001/";
const requestHeader = {
  headers: {
    "Authorization": "Bearer " + _config.apiConfig.authenticationToken
  }
};

const userLogin = credentials => {
  return new Promise((resolve, reject) => {
    postCall("users/login", credentials).then(result => {
      if (result.status === 200) {
        console.log(result);
        _config.apiConfig.authenticationToken = result.data.token;
        _config.apiConfig.userId = result.data.id;
        resolve();
      } else if (result.status === 401) {
        console.log("unauthorized");
        reject();
      }
    }).catch(err => {
      console.log("rejected");
      reject();
    });
  });
};

exports.userLogin = userLogin;

const getOrderItems = orderId => {
  return new Promise((resolve, reject) => {
    authenticatedGetCall("orders/" + orderId).then(result => {
      resolve(result);
    }).catch(err => {
      reject();
    });
  });
};

exports.getOrderItems = getOrderItems;

const updateOrder = (orderId, updateOps) => {
  return new Promise((resolve, reject) => {
    putCall("orders/" + orderId, updateOps).then(result => {
      resolve(result);
    }).catch(err => {
      reject();
    });
  });
}; // this needs to be changed


exports.updateOrder = updateOrder;

const getUsersOrders = () => {
  return new Promise((resolve, reject) => {
    console.log(_config.apiConfig.userId);
    authenticatedGetCall("orders/all/" + _config.apiConfig.userId).then(result => {
      resolve(result);
    }).catch(err => {
      reject();
    });
  });
};

exports.getUsersOrders = getUsersOrders;

const getMenuItems = () => {
  return new Promise((resolve, reject) => {
    authenticatedGetCall("items/").then(result => {
      resolve(result);
    }).catch(err => {
      reject();
    });
  });
};
/*
    POST, GET, PUT calls defined
 */


exports.getMenuItems = getMenuItems;

function postCall(url, mydata) {
  return new Promise((resolve, reject) => {
    let callingUrl = baseUrl + url; // resolve(axios.post(callingUrl, mydata)
    //     .then(response => {
    //         return response;
    //     }));

    _axios.default.post(callingUrl, mydata).then(response => {
      if (response.status === 200 || response.status === 201 || response.status === 401) {
        resolve(response);
      } else if (response.status === 500) {
        console.log("error calling api post call");
        reject();
      } else {
        console.log("unexpected error code");
        reject();
      }
    }).catch(err => {
      console.log(err);
    });
  });
}

function authenticatedGetCall(url, header) {
  const requestHeader = {
    headers: {
      "Authorization": "Bearer " + _config.apiConfig.authenticationToken
    }
  };
  return new Promise((resolve, reject) => {
    let callingUrl = baseUrl + url;
    resolve(_axios.default.get(callingUrl, requestHeader).then(response => {
      return response;
    }));
  });
}

function putCall(url, updateOps) {
  return new Promise((resolve, reject) => {
    let callingUrl = baseUrl + url;
    resolve(_axios.default.put(callingUrl, updateOps).then(response => {
      return response;
    }));
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhbGxBcGkuanMiXSwibmFtZXMiOlsiYmFzZVVybCIsInJlcXVlc3RIZWFkZXIiLCJoZWFkZXJzIiwiYXBpQ29uZmlnIiwiYXV0aGVudGljYXRpb25Ub2tlbiIsInVzZXJMb2dpbiIsImNyZWRlbnRpYWxzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJwb3N0Q2FsbCIsInRoZW4iLCJyZXN1bHQiLCJzdGF0dXMiLCJjb25zb2xlIiwibG9nIiwiZGF0YSIsInRva2VuIiwidXNlcklkIiwiaWQiLCJjYXRjaCIsImVyciIsImdldE9yZGVySXRlbXMiLCJvcmRlcklkIiwiYXV0aGVudGljYXRlZEdldENhbGwiLCJ1cGRhdGVPcmRlciIsInVwZGF0ZU9wcyIsInB1dENhbGwiLCJnZXRVc2Vyc09yZGVycyIsImdldE1lbnVJdGVtcyIsInVybCIsIm15ZGF0YSIsImNhbGxpbmdVcmwiLCJheGlvcyIsInBvc3QiLCJyZXNwb25zZSIsImhlYWRlciIsImdldCIsInB1dCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBRUEsTUFBTUEsT0FBTyxHQUFHLHdCQUFoQjtBQUVBLE1BQU1DLGFBQWEsR0FBRztBQUFFQyxFQUFBQSxPQUFPLEVBQUU7QUFBRSxxQkFBaUIsWUFBWUMsa0JBQVVDO0FBQXpDO0FBQVgsQ0FBdEI7O0FBRU8sTUFBTUMsU0FBUyxHQUFJQyxXQUFELElBQWlCO0FBQ3RDLFNBQU8sSUFBSUMsT0FBSixDQUFZLENBQUNDLE9BQUQsRUFBVUMsTUFBVixLQUFxQjtBQUNwQ0MsSUFBQUEsUUFBUSxDQUFDLGFBQUQsRUFBZ0JKLFdBQWhCLENBQVIsQ0FDS0ssSUFETCxDQUNVQyxNQUFNLElBQUk7QUFDWixVQUFJQSxNQUFNLENBQUNDLE1BQVAsS0FBa0IsR0FBdEIsRUFBMEI7QUFDdEJDLFFBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZSCxNQUFaO0FBQ0FULDBCQUFVQyxtQkFBVixHQUFnQ1EsTUFBTSxDQUFDSSxJQUFQLENBQVlD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LE9BQUosQ0FBWSxDQUFDQyxPQUFELEVBQVVDLE1BQVYsS0FBcUI7QUFDcEMsUUFBSXVCLFVBQVUsR0FBR2hDLE9BQU8sR0FBRzhCLEdBQTNCO0FBQ0F0QixJQUFBQSxPQUFPLENBQUN5QixlQUFNSyxHQUFOLENBQVVOLFVBQVYsRUFBcUJOLFNBQXJCLEVBQ0hmLElBREcsQ0FDRXdCLFFBQVEsSUFBSTtBQUNkLGFBQU9BLFFBQVA7QUFDSCxLQUhHLENBQUQsQ0FBUDtBQUlILEdBTk0sQ0FBUDtBQU9IIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXBpQ29uZmlnIH0gZnJvbSAnLi4vYXBpQ2FsbHMvY29uZmlnJztcbmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XG5cbmNvbnN0IGJhc2VVcmwgPSBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMS9cIjtcblxuY29uc3QgcmVxdWVzdEhlYWRlciA9IHsgaGVhZGVyczogeyBcIkF1dGhvcml6YXRpb25cIjogXCJCZWFyZXIgXCIgKyBhcGlDb25maWcuYXV0aGVudGljYXRpb25Ub2tlbiB9IH1cblxuZXhwb3J0IGNvbnN0IHVzZXJMb2dpbiA9IChjcmVkZW50aWFscykgPT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIHBvc3RDYWxsKFwidXNlcnMvbG9naW5cIiwgY3JlZGVudGlhbHMpXG4gICAgICAgICAgICAudGhlbihyZXN1bHQgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDApe1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICBhcGlDb25maWcuYXV0aGVudGljYXRpb25Ub2tlbiA9IHJlc3VsdC5kYXRhLnRva2VuO1xuICAgICAgICAgICAgICAgICAgICBhcGlDb25maWcudXNlcklkID0gcmVzdWx0LmRhdGEuaWQ7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocmVzdWx0LnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidW5hdXRob3JpemVkXCIpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG5cblxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVqZWN0ZWRcIik7XG4gICAgICAgICAgICAgICAgcmVqZWN0KCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IGNvbnN0IGdldE9yZGVySXRlbXMgPSAob3JkZXJJZCkgPT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGF1dGhlbnRpY2F0ZWRHZXRDYWxsKFwib3JkZXJzL1wiK29yZGVySWQpXG4gICAgICAgICAgICAudGhlbihyZXN1bHQgPT4ge1xuICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcblxuXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7cmVqZWN0KCl9KTtcbiAgICB9KTtcbn1cblxuXG5leHBvcnQgY29uc3QgdXBkYXRlT3JkZXIgPSAob3JkZXJJZCwgdXBkYXRlT3BzKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgcHV0Q2FsbChcIm9yZGVycy9cIiArIG9yZGVySWQsIHVwZGF0ZU9wcylcbiAgICAgICAgICAgIC50aGVuKHJlc3VsdCA9PiB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChlcnIgPT4ge3JlamVjdCgpfSk7XG4gICAgfSk7XG59XG5cblxuLy8gdGhpcyBuZWVkcyB0byBiZSBjaGFuZ2VkXG5leHBvcnQgY29uc3QgZ2V0VXNlcnNPcmRlcnMgPSAoKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coYXBpQ29uZmlnLnVzZXJJZCk7XG4gICAgICAgIGF1dGhlbnRpY2F0ZWRHZXRDYWxsKFwib3JkZXJzL2FsbC9cIiArIGFwaUNvbmZpZy51c2VySWQpXG4gICAgICAgICAgICAudGhlbihyZXN1bHQgPT4ge1xuICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtyZWplY3QoKX0pO1xuICAgIH0pO1xufVxuXG5cbmV4cG9ydCBjb25zdCBnZXRNZW51SXRlbXMgPSAoKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgYXV0aGVudGljYXRlZEdldENhbGwoXCJpdGVtcy9cIilcbiAgICAgICAgICAgIC50aGVuKHJlc3VsdCA9PiB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChlcnIgPT4ge3JlamVjdCgpfSk7XG4gICAgfSk7XG59XG5cblxuLypcbiAgICBQT1NULCBHRVQsIFBVVCBjYWxscyBkZWZpbmVkXG4gKi9cblxuZnVuY3Rpb24gcG9zdENhbGwodXJsLCBteWRhdGEpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBsZXQgY2FsbGluZ1VybCA9IGJhc2VVcmwgKyB1cmw7XG4gICAgICAgIC8vIHJlc29sdmUoYXhpb3MucG9zdChjYWxsaW5nVXJsLCBteWRhdGEpXG4gICAgICAgIC8vICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgIC8vICAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgICAgICAvLyAgICAgfSkpO1xuICAgICAgICBheGlvcy5wb3N0KGNhbGxpbmdVcmwsIG15ZGF0YSlcbiAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCB8fCByZXNwb25zZS5zdGF0dXMgPT09IDIwMSB8fCByZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA1MDApe1xuICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlcnJvciBjYWxsaW5nIGFwaSBwb3N0IGNhbGxcIik7XG4gICAgICAgICAgICAgICAgICAgICByZWplY3QoKTtcbiAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1bmV4cGVjdGVkIGVycm9yIGNvZGVcIik7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCgpO1xuICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgfVxuICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgIH0pO1xuICAgIH0pO1xufVxuXG5cbmZ1bmN0aW9uIGF1dGhlbnRpY2F0ZWRHZXRDYWxsKHVybCwgaGVhZGVyKSB7XG4gICAgY29uc3QgcmVxdWVzdEhlYWRlciA9IHsgaGVhZGVyczogeyBcIkF1dGhvcml6YXRpb25cIjogXCJCZWFyZXIgXCIgKyBhcGlDb25maWcuYXV0aGVudGljYXRpb25Ub2tlbiB9IH07XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBsZXQgY2FsbGluZ1VybCA9IGJhc2VVcmwgKyB1cmw7XG4gICAgICAgIHJlc29sdmUoYXhpb3MuZ2V0KGNhbGxpbmdVcmwsIHJlcXVlc3RIZWFkZXIpXG4gICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgICAgICAgICAgfSkpO1xuICAgIH0pO1xufVxuXG5cbmZ1bmN0aW9uIHB1dENhbGwodXJsLCB1cGRhdGVPcHMpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBsZXQgY2FsbGluZ1VybCA9IGJhc2VVcmwgKyB1cmw7XG4gICAgICAgIHJlc29sdmUoYXhpb3MucHV0KGNhbGxpbmdVcmwsdXBkYXRlT3BzKVxuICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICAgICAgICAgIH0pKTtcbiAgICB9KTtcbn0iXX0=