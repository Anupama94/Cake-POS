69af332bcc8e8cf23434f2aa37988c2e
"use strict";

var _interopRequireDefault = require("/home/anupamaa/Desktop/Training/pos/server/client/node_modules/@babel/runtime/helpers/interopRequireDefault");

var _react = _interopRequireDefault(require("react"));

var _reactDom = _interopRequireDefault(require("react-dom"));

var _enzyme = require("enzyme");

var _LoginBox = require("../Login/LoginBox");

var _enzymeToJson = require("enzyme-to-json");

var _jsxFileName = "/home/anupamaa/Desktop/Training/pos/server/client/src/components/tests/loginbox.test.js";
describe("LoginBox Component", () => {
  let wrapper;
  let initialState = {
    email: '',
    password: '',
    validate: {
      emailState: '',
      passwordState: ''
    },
    errorAlert: {
      visible: false,
      message: ''
    }
  };
  beforeEach(() => {
    wrapper = (0, _enzyme.shallow)(_react.default.createElement(_LoginBox.LoginBox, {
      __source: {
        fileName: _jsxFileName,
        lineNumber: 25
      },
      __self: void 0
    }));
  });
  it("should render correctly", () => {
    expect((0, _enzymeToJson.shallowToJson)(wrapper)).toMatchSnapshot();
  });
  it('when submit button is clicked without username nor password emailState should be set to has-danger', () => {
    const logInSpy = jest.spyOn(wrapper.instance(), "submitLogin");
    wrapper.instance().forceUpdate();
    expect(logInSpy).not.toHaveBeenCalled();
    wrapper.find('button.login-btn').simulate('click');
    expect(logInSpy).toHaveBeenCalledTimes(1);
    expect(wrapper.state().validate.emailState).toBe("has-danger");
  });
  it('when submit button is clicked with username but no password password-state should be set to has-danger', () => {
    const logInSpy = jest.spyOn(wrapper.instance(), "submitLogin");
    wrapper.setState({
      validate: {
        emailState: 'has-success'
      }
    });
    wrapper.instance().forceUpdate();
    expect(logInSpy).not.toHaveBeenCalled();
    wrapper.find('button.login-btn').simulate('click');
    expect(logInSpy).toHaveBeenCalledTimes(1);
    expect(wrapper.state().validate.passwordState).toBe("has-danger");
  });
  it('when submit button is clicked with password but no username email-state should be set to has-danger', () => {
    const logInSpy = jest.spyOn(wrapper.instance(), "submitLogin");
    wrapper.setState({
      validate: {
        passwordState: 'has-success'
      }
    });
    wrapper.instance().forceUpdate();
    expect(logInSpy).not.toHaveBeenCalled();
    wrapper.find('button.login-btn').simulate('click');
    expect(logInSpy).toHaveBeenCalledTimes(1);
    expect(wrapper.state().validate.emailState).toBe("has-danger");
  });
  it('when submit button is clicked with invalid username and password authentication should be failed and alert should be displayed', () => {
    jest.unmock('../../apiCalls/callApi');
    const logInSpy = jest.spyOn(wrapper.instance(), "submitLogin");

    const apiCall = require('../../apiCalls/callApi');

    apiCall.userLogin = jest.fn(({}) => Promise.reject({
      message: "message",
      code: "code"
    }));
    wrapper.setState({
      validate: {
        emailState: 'has-success',
        passwordState: 'has-success'
      }
    });
    wrapper.instance().forceUpdate();
    expect(logInSpy).not.toHaveBeenCalled();
    wrapper.find('button.login-btn').simulate('click');
    expect(logInSpy).toHaveBeenCalledTimes(1);
    expect(apiCall.userLogin.mock.results.value).toBe({
      message: "message",
      code: "code"
    });
    expect(wrapper.state().errorAlert.visible).toBe(true);
  });
  it('when submit button is clicked with valid username and password, should be routed to the orderlist', () => {
    jest.unmock('../../apiCalls/callApi');
    const logInSpy = jest.spyOn(wrapper.instance(), "submitLogin");

    const apiCall = require('../../apiCalls/callApi');

    apiCall.userLogin = jest.fn(({}) => Promise.reject(() => {
      (void 0).setState({
        email: '',
        password: ''
      });
      (void 0).setState({
        validate: {
          emailState: 'has-danger'
        }
      });
      (void 0).setState({
        errorAlert: {
          visible: true,
          message: err.message
        }
      });
    }));
    wrapper.setState({
      validate: {
        emailState: 'has-success',
        passwordState: 'has-success'
      }
    });
    wrapper.instance().forceUpdate();
    expect(logInSpy).not.toHaveBeenCalled();
    wrapper.find('button.login-btn').simulate('click');
    expect(logInSpy).toHaveBeenCalledTimes(1);
    expect(apiCall.userLogin).toHaveBeenCalledTimes(1); //expect(wrapper.state().errorAlert.visible).toBe(true);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2luYm94LnRlc3QuanMiXSwibmFtZXMiOlsiZGVzY3JpYmUiLCJ3cmFwcGVyIiwiaW5pdGlhbFN0YXRlIiwiZW1haWwiLCJwYXNzd29yZCIsInZhbGlkYXRlIiwiZW1haWxTdGF0ZSIsInBhc3N3b3JkU3RhdGUiLCJlcnJvckFsZXJ0IiwidmlzaWJsZSIsIm1lc3NhZ2UiLCJiZWZvcmVFYWNoIiwiaXQiLCJleHBlY3QiLCJ0b01hdGNoU25hcHNob3QiLCJsb2dJblNweSIsImplc3QiLCJzcHlPbiIsImluc3RhbmNlIiwiZm9yY2VVcGRhdGUiLCJub3QiLCJ0b0hhdmVCZWVuQ2FsbGVkIiwiZmluZCIsInNpbXVsYXRlIiwidG9IYXZlQmVlbkNhbGxlZFRpbWVzIiwic3RhdGUiLCJ0b0JlIiwic2V0U3RhdGUiLCJ1bm1vY2siLCJhcGlDYWxsIiwicmVxdWlyZSIsInVzZXJMb2dpbiIsImZuIiwiUHJvbWlzZSIsInJlamVjdCIsImNvZGUiLCJtb2NrIiwicmVzdWx0cyIsInZhbHVlIiwiZXJyIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7OztBQUdBQSxRQUFRLENBQUMsb0JBQUQsRUFBdUIsTUFBTTtBQUVuQyxNQUFJQyxPQUFKO0FBQ0EsTUFBSUMsWUFBWSxHQUFHO0FBQ2pCQyxJQUFBQSxLQUFLLEVBQUUsRUFEVTtBQUVqQkMsSUFBQUEsUUFBUSxFQUFFLEVBRk87QUFHakJDLElBQUFBLFFBQVEsRUFBRTtBQUNSQyxNQUFBQSxVQUFVLEVBQUUsRUFESjtBQUVSQyxNQUFBQSxhQUFhLEVBQUU7QUFGUCxLQUhPO0FBT2pCQyxJQUFBQSxVQUFVLEVBQUU7QUFDVkMsTUFBQUEsT0FBTyxFQUFFLEtBREM7QUFFVkMsTUFBQUEsT0FBTyxFQUFFO0FBRkM7QUFQSyxHQUFuQjtBQWFBQyxFQUFBQSxVQUFVLENBQUMsTUFBTTtBQUNmVixJQUFBQSxPQUFPLEdBQUcscUJBQVEsNkJBQUMsa0JBQUQ7QUFBQTtBQUFBO0FBQUE7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cUJDLGdCQUFyQjtBQUNBcEIsSUFBQUEsT0FBTyxDQUFDcUIsSUFBUixDQUFhLGtCQUFiLEVBQWlDQyxRQUFqQyxDQUEwQyxPQUExQztBQUNBVixJQUFBQSxNQUFNLENBQUNFLFFBQUQsQ0FBTixDQUFpQlMscUJBQWpCLENBQXVDLENBQXZDO0FBQ0FYLElBQUFBLE1BQU0sQ0FBQ2dCLE9BQU8sQ0FBQ0UsU0FBVCxDQUFOLENBQTBCUCxxQkFBMUIsQ0FBZ0QsQ0FBaEQsRUFoQjRHLENBaUI1RztBQUVELEdBbkJDLENBQUY7QUF3QkQsQ0FoSE8sQ0FBUiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUmVhY3RET00gZnJvbSAncmVhY3QtZG9tJztcbmltcG9ydCB7IHNoYWxsb3cgfSBmcm9tICdlbnp5bWUnO1xuaW1wb3J0IHsgTG9naW5Cb3ggfSBmcm9tICcuLi9Mb2dpbi9Mb2dpbkJveCdcbmltcG9ydCB7IHNoYWxsb3dUb0pzb24gfSBmcm9tICdlbnp5bWUtdG8tanNvbic7XG5cblxuZGVzY3JpYmUoXCJMb2dpbkJveCBDb21wb25lbnRcIiwgKCkgPT4ge1xuXG4gIGxldCB3cmFwcGVyO1xuICBsZXQgaW5pdGlhbFN0YXRlID0ge1xuICAgIGVtYWlsOiAnJyxcbiAgICBwYXNzd29yZDogJycsXG4gICAgdmFsaWRhdGU6IHtcbiAgICAgIGVtYWlsU3RhdGU6ICcnLFxuICAgICAgcGFzc3dvcmRTdGF0ZTogJydcbiAgICB9LFxuICAgIGVycm9yQWxlcnQ6IHtcbiAgICAgIHZpc2libGU6IGZhbHNlLFxuICAgICAgbWVzc2FnZTogJydcbiAgICB9XG4gIH07XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgd3JhcHBlciA9IHNoYWxsb3coPExvZ2luQm94IC8+KTtcbiAgfVxuICApO1xuXG4gIGl0KFwic2hvdWxkIHJlbmRlciBjb3JyZWN0bHlcIiwgKCkgPT4ge1xuICAgIGV4cGVjdChzaGFsbG93VG9Kc29uKHdyYXBwZXIpKS50b01hdGNoU25hcHNob3QoKTtcbiAgfSk7XG5cblxuICBpdCgnd2hlbiBzdWJtaXQgYnV0dG9uIGlzIGNsaWNrZWQgd2l0aG91dCB1c2VybmFtZSBub3IgcGFzc3dvcmQgZW1haWxTdGF0ZSBzaG91bGQgYmUgc2V0IHRvIGhhcy1kYW5nZXInLCAoKSA9PiB7XG4gICAgY29uc3QgbG9nSW5TcHkgPSBqZXN0LnNweU9uKHdyYXBwZXIuaW5zdGFuY2UoKSwgXCJzdWJtaXRMb2dpblwiKTtcblxuICAgIHdyYXBwZXIuaW5zdGFuY2UoKS5mb3JjZVVwZGF0ZSgpO1xuICAgIGV4cGVjdChsb2dJblNweSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB3cmFwcGVyLmZpbmQoJ2J1dHRvbi5sb2dpbi1idG4nKS5zaW11bGF0ZSgnY2xpY2snKTtcbiAgICBleHBlY3QobG9nSW5TcHkpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICBleHBlY3Qod3JhcHBlci5zdGF0ZSgpLnZhbGlkYXRlLmVtYWlsU3RhdGUpLnRvQmUoXCJoYXMtZGFuZ2VyXCIpO1xuXG5cbiAgfSk7XG5cbiAgaXQoJ3doZW4gc3VibWl0IGJ1dHRvbiBpcyBjbGlja2VkIHdpdGggdXNlcm5hbWUgYnV0IG5vIHBhc3N3b3JkIHBhc3N3b3JkLXN0YXRlIHNob3VsZCBiZSBzZXQgdG8gaGFzLWRhbmdlcicsICgpID0+IHtcbiAgICBjb25zdCBsb2dJblNweSA9IGplc3Quc3B5T24od3JhcHBlci5pbnN0YW5jZSgpLCBcInN1Ym1pdExvZ2luXCIpO1xuICAgIHdyYXBwZXIuc2V0U3RhdGUoe3ZhbGlkYXRlOiB7ZW1haWxTdGF0ZTogJ2hhcy1zdWNjZXNzJ319KTtcbiAgICB3cmFwcGVyLmluc3RhbmNlKCkuZm9yY2VVcGRhdGUoKTtcbiAgICBleHBlY3QobG9nSW5TcHkpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgd3JhcHBlci5maW5kKCdidXR0b24ubG9naW4tYnRuJykuc2ltdWxhdGUoJ2NsaWNrJyk7XG4gICAgZXhwZWN0KGxvZ0luU3B5KS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgZXhwZWN0KHdyYXBwZXIuc3RhdGUoKS52YWxpZGF0ZS5wYXNzd29yZFN0YXRlKS50b0JlKFwiaGFzLWRhbmdlclwiKTtcblxuXG4gIH0pO1xuXG5cbiAgaXQoJ3doZW4gc3VibWl0IGJ1dHRvbiBpcyBjbGlja2VkIHdpdGggcGFzc3dvcmQgYnV0IG5vIHVzZXJuYW1lIGVtYWlsLXN0YXRlIHNob3VsZCBiZSBzZXQgdG8gaGFzLWRhbmdlcicsICgpID0+IHtcbiAgICBjb25zdCBsb2dJblNweSA9IGplc3Quc3B5T24od3JhcHBlci5pbnN0YW5jZSgpLCBcInN1Ym1pdExvZ2luXCIpO1xuICAgIHdyYXBwZXIuc2V0U3RhdGUoe3ZhbGlkYXRlOiB7cGFzc3dvcmRTdGF0ZTogJ2hhcy1zdWNjZXNzJ319KTtcbiAgICB3cmFwcGVyLmluc3RhbmNlKCkuZm9yY2VVcGRhdGUoKTtcbiAgICBleHBlY3QobG9nSW5TcHkpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgd3JhcHBlci5maW5kKCdidXR0b24ubG9naW4tYnRuJykuc2ltdWxhdGUoJ2NsaWNrJyk7XG4gICAgZXhwZWN0KGxvZ0luU3B5KS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgZXhwZWN0KHdyYXBwZXIuc3RhdGUoKS52YWxpZGF0ZS5lbWFpbFN0YXRlKS50b0JlKFwiaGFzLWRhbmdlclwiKTtcblxuXG4gIH0pO1xuXG5cbiAgaXQoJ3doZW4gc3VibWl0IGJ1dHRvbiBpcyBjbGlja2VkIHdpdGggaW52YWxpZCB1c2VybmFtZSBhbmQgcGFzc3dvcmQgYXV0aGVudGljYXRpb24gc2hvdWxkIGJlIGZhaWxlZCBhbmQgYWxlcnQgc2hvdWxkIGJlIGRpc3BsYXllZCcsICgpID0+IHtcbiAgICBjb25zdCBsb2dJblNweSA9IGplc3Quc3B5T24od3JhcHBlci5pbnN0YW5jZSgpLCBcInN1Ym1pdExvZ2luXCIpO1xuICAgIGplc3QudW5tb2NrKCcuLi8uLi9hcGlDYWxscy9jYWxsQXBpJyk7XG5cbiAgICBjb25zdCBhcGlDYWxsID0gcmVxdWlyZSgnLi4vLi4vYXBpQ2FsbHMvY2FsbEFwaScpO1xuICAgIGFwaUNhbGwudXNlckxvZ2luID0gamVzdC5mbigoe30pID0+IFByb21pc2UucmVqZWN0KHtcbiAgICAgIG1lc3NhZ2U6IFwibWVzc2FnZVwiLFxuICAgICAgY29kZTogXCJjb2RlXCJcbiAgfSkpO1xuICAgIFxuICAgIHdyYXBwZXIuc2V0U3RhdGUoe3ZhbGlkYXRlOiB7ZW1haWxTdGF0ZTogJ2hhcy1zdWNjZXNzJyxwYXNzd29yZFN0YXRlOiAnaGFzLXN1Y2Nlc3MnfX0pO1xuICAgIHdyYXBwZXIuaW5zdGFuY2UoKS5mb3JjZVVwZGF0ZSgpO1xuICAgIGV4cGVjdChsb2dJblNweSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB3cmFwcGVyLmZpbmQoJ2J1dHRvbi5sb2dpbi1idG4nKS5zaW11bGF0ZSgnY2xpY2snKTtcbiAgICBleHBlY3QobG9nSW5TcHkpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICBleHBlY3QoYXBpQ2FsbC51c2VyTG9naW4ubW9jay5yZXN1bHRzLnZhbHVlKS50b0JlKHtcbiAgICAgIG1lc3NhZ2U6IFwibWVzc2FnZVwiLFxuICAgICAgY29kZTogXCJjb2RlXCJcbiAgfSk7XG4gICAgZXhwZWN0KHdyYXBwZXIuc3RhdGUoKS5lcnJvckFsZXJ0LnZpc2libGUpLnRvQmUodHJ1ZSk7XG5cbiAgfSk7XG5cblxuICBpdCgnd2hlbiBzdWJtaXQgYnV0dG9uIGlzIGNsaWNrZWQgd2l0aCB2YWxpZCB1c2VybmFtZSBhbmQgcGFzc3dvcmQsIHNob3VsZCBiZSByb3V0ZWQgdG8gdGhlIG9yZGVybGlzdCcsICgpID0+IHtcbiAgICBjb25zdCBsb2dJblNweSA9IGplc3Quc3B5T24od3JhcHBlci5pbnN0YW5jZSgpLCBcInN1Ym1pdExvZ2luXCIpO1xuICAgIGplc3QudW5tb2NrKCcuLi8uLi9hcGlDYWxscy9jYWxsQXBpJyk7XG5cbiAgICBjb25zdCBhcGlDYWxsID0gcmVxdWlyZSgnLi4vLi4vYXBpQ2FsbHMvY2FsbEFwaScpO1xuICAgIGFwaUNhbGwudXNlckxvZ2luID0gamVzdC5mbigoe30pID0+IFByb21pc2UucmVqZWN0KCgpID0+IHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBlbWFpbDogJycsIHBhc3N3b3JkOiAnJyB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgdmFsaWRhdGU6IHtlbWFpbFN0YXRlOiAnaGFzLWRhbmdlcid9IH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2Vycm9yQWxlcnQ6IHt2aXNpYmxlOiB0cnVlLCBtZXNzYWdlOiBlcnIubWVzc2FnZX19KTtcbiAgICB9KSk7XG4gICAgXG4gICAgd3JhcHBlci5zZXRTdGF0ZSh7dmFsaWRhdGU6IHtlbWFpbFN0YXRlOiAnaGFzLXN1Y2Nlc3MnLHBhc3N3b3JkU3RhdGU6ICdoYXMtc3VjY2Vzcyd9fSk7XG4gICAgd3JhcHBlci5pbnN0YW5jZSgpLmZvcmNlVXBkYXRlKCk7XG4gICAgZXhwZWN0KGxvZ0luU3B5KS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIHdyYXBwZXIuZmluZCgnYnV0dG9uLmxvZ2luLWJ0bicpLnNpbXVsYXRlKCdjbGljaycpO1xuICAgIGV4cGVjdChsb2dJblNweSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIGV4cGVjdChhcGlDYWxsLnVzZXJMb2dpbikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIC8vZXhwZWN0KHdyYXBwZXIuc3RhdGUoKS5lcnJvckFsZXJ0LnZpc2libGUpLnRvQmUodHJ1ZSk7XG5cbiAgfSk7XG5cblxuXG5cbn0pO1xuIl19